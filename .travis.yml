sudo: false

language: python
python:
 - 2.7

addons:
  apt:
    sources:
      - libsdl1.2debian
      - libfdt1
      - libpixman-1-0

before_install:
 - pip install virtualenv

install:
 - mkdir pebble-dev
 - cd pebble-dev
 - curl -O https://s3.amazonaws.com/assets.getpebble.com/pebble-tool/pebble-sdk-$PEBBLE_TOOL-linux64.tar.bz2
 - tar -jxf pebble-sdk-$PEBBLE_TOOL-linux64.tar.bz2
 - cd pebble-sdk-$PEBBLE_TOOL-linux64
 - virtualenv --no-site-packages .env
 - source .env/bin/activate
 - pip install -r requirements.txt
 - pip install cpplint
 - deactivate

script:
 - yes | ./pebble-dev/pebble-sdk-$PEBBLE_TOOL-linux64/bin/pebble build
 - source ./pebble-dev/pebble-sdk-$PEBBLE_TOOL-linux64/.env/bin/activate
 - cpplint src/*
 - deactivate

env:
  global:
    - PEBBLE_TOOL=4.2

branches:
  only:
    - master
